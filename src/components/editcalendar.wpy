<template>
 <view>
   <van-cell-group>
       <van-field
    value="{{ calendarinfo.name }}"
    label="日程名称："
    placeholder="请输入日程名称"
    border="{{ false }}"
    id="name"
    bind:change="onChange"
  />
  <van-field
    value="{{ calendarinfo.siteId }}"
     label="预约场地名称："
    placeholder="请输入预约场地名称"
    border="{{ false }}" 
    id="siteId"
    bind:change="onChange"
    bind:focus ="onasfocus"
  />
  <van-field
    value="{{ calendarinfo.venueId }}"
     label="预约场馆名称："
    placeholder="请输入预约场馆名称"
    border="{{ false }}"
    id="venueId"
    bind:change="onChange"
  />
  <van-field
    value="{{ calendarinfo.receptionDateTime }}"
     label="接待时间："
    placeholder="请输入接待时间"
    border="{{ false }}"
    id="receptionDateTime"
    disabled
    bind:change="onChange"
  >
    <van-button bindtap="opentime" slot="button" size="small" type="info">选择时间</van-button>
    </van-field>
  <van-field
    value="{{ calendarinfo.receptionId }}"
      label="接待人名称："
    placeholder="请输入接待人名称"
    border="{{ false }}"
        id="receptionId"
    bind:change="onChange"
  />
  <van-field
    value="{{ calendarinfo.customerId }}"
      label="客户："
    placeholder="请输入客户"
    border="{{ false }}"
        id="customerId"
    bind:change="onChange"
  />
   <van-field
    value="{{ calendarinfo.dockingName }}"
      label="对接人名称："
    placeholder="请输入对接人名称"
    border="{{ false }}"
        id="dockingName"
    bind:change="onChange"
  />
  <van-field
    value="{{ calendarinfo.dockingMobile }}"
        label="对接人联系方式："
    placeholder="请输入对接人联系方式"
    border="{{ false }}"
        id="dockingMobile"
    bind:change="onChange"
  />
</van-cell-group>
<!-- <van-button type="default">默认按钮</van-button>
<van-button type="info">信息按钮</van-button> -->
<button bindtap="aaa">asdas</button>

<!--                控件                  -->
 <van-popup
   show="{{ showpop }}"
  closeable
  position="bottom"
  custom-style="height: 50%"
  bind:close="onClose"
  z-index="610"
>
  <van-datetime-picker
  type="time"
  value="{{ currentDate }}"
  min-hour="{{ minHour }}"
  max-hour="{{ maxHour }}"
  bind:input="onInput"
/>
</van-popup>

<van-popup
   show="{{ showpk }}"
  closeable
  position="bottom"
  custom-style="height: 50%"
  bind:close="onClose"
  overlay="true"
  z-index="610"
>
<view>
<van-picker columns="{{ columns }}" bind:change="onChange" />
</view>
</van-popup>

 </view>
</template>

<script>
import wepy from 'wepy';
import Calendar from 'wepy-com-calendar';
import { connect } from 'wepy-redux';
import moment from 'moment';
import { stringify } from 'qs';

@connect({})
export default class editcalendar extends wepy.page {
  config = {
    usingComponents: {
      'van-icon': '../../static/plugIn/icon/index',
      'van-cell': '../../static/plugIn/cell/index',
      'van-cell-group': '../../static/plugIn/cell-group/index',
      'van-field': '../../static/plugIn/field/index',
      'van-button': '../../static/plugIn/button/index',
      'van-popup': '../../static/plugIn/popup/index',
      'van-action-sheet': '../../static/plugIn/action-sheet/index',
      'van-datetime-picker': '../../static/plugIn/datetime-picker/index',
      'van-picker': '../../static/plugIn/picker/index'
    }
  };
  props = {};
  data = {
    calendarinfo: {},
    username: '',
    password: '',
    asshow: false,
    columns: [],
    currentDate: '12:00',
    minHour: 10,
    maxHour: 20,
    showpop: false,
    showpk: false
  };
  onChange(event) {
    // event.detail 为当前输入的值
    console.log(event.detail);
  }
  components = {};
  onLoad() {
    this.getsitelist();
    this.currentDate = new Date().getTime();
  }
  getsitelist() {
    wx.request({
      url: `http://localhost:5000/ERP/SRM/Site/Read/Rows`,
      method: 'POST',
      header: {
        'content-type': 'application/x-www-form-urlencoded'
        //Authorization:'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9zaWQiOiIxIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6ImFkbWluIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvc3VybmFtZSI6Iua9mOa0gee-pCIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6ImFkbWluIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZWlkZW50aWZpZXIiOiJFUlBBcGkuRW50aXRpZXMuQVZNLlVzZXIiLCJpcCI6IjEyNy4wLjAuMSIsIm5iZiI6MTU3Mzk3NDU1MCwiZXhwIjoxNTc0MDYwOTUwLCJpc3MiOiJvY2Vsb3QiLCJhdWQiOiJldmVyeW9uZSJ9.lwPyby8LJfPjH_XigknRGsN_tLFYt4-KEvUa6GA596o'
      },
      success: res => {
        if (res && res) {
          console.log(res.data.rows);
          //this.columns = res.data.rows.map(p => p.name);
        }
      },
      fail: err => {
        console.log(err);
      }
    });
  }
  methods = {
    aaa() {
      console.log(1), console.log('calendarinfo', this.calendarinfo);
    },
    onChange(e) {
      switch (e.target.id) {
        case 'name':
          this.calendarinfo.name = e.detail;
          break;
        case 'siteId':
          this.calendarinfo.siteId = e.detail;
          break;
        case 'venueId':
          this.calendarinfo.venueId = e.detail;
          break;
        case 'receptionDateTime':
          this.calendarinfo.receptionDateTime = e.detail;
          break;
        case 'receptionId':
          this.calendarinfo.receptionId = e.detail;
          break;
        case 'customerId':
          this.calendarinfo.customerId = e.detail;
          break;
        case 'dockingName':
          this.calendarinfo.dockingName = e.detail;
          break;
        case 'dockingMobile':
          this.calendarinfo.dockingMobile = e.detail;
          break;
      }
    },
    onasfocus() {
      this.showpk = true;
      console.log(' this.showpk', this.showpk);
    },
    opentime() {
      this.showpop = true;
    },
    onClose() {
      this.showpop = false;
      this.showpk = false;
    },
    onInput(event) {
      this.setData({
        currentDate: event.detail
      });
    }
  };
}
</script>